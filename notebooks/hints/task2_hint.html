<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>課題2 ヒント</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; margin: 20px; background-color: #f4f7f9; color: #333; }
        .container { max-width: 800px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1, h2 { border-bottom: 2px solid #e0e0e0; padding-bottom: 10px; }
        .hint-section { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .hint-button { background-color: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 14px; margin-right: 5px; margin-bottom: 5px; }
        .hint-button:hover { background-color: #218838; }
        .hint-content { display: none; background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px; padding: 15px; margin-top: 10px; }
        code { background-color: #eee; padding: 2px 4px; border-radius: 3px; }
    </style>
</head>
<body>

    <div class="container">
        <h1>課題2: 信号処理関数の実装</h1>
        <p>各関数のヒントを順番に見て、実装に挑戦してみましょう！</p>

        <!-- Low-pass Filter -->
        <div class="hint-section">
            <h2>Low-pass Filter (LPF)</h2>
            <p>高い周波数のノイズを取り除き、信号を滑らかにします。</p>
            <button class="hint-button" onclick="toggleHint('lpf1')">ヒント1: 考え方</button>
            <button class="hint-button" onclick="toggleHint('lpf2')">ヒント2: 使う関数</button>
            <button class="hint-button" onclick="toggleHint('lpf3')">ヒント3: 実装のコツ</button>
            <div id="lpf1" class="hint-content"><b>考え方:</b> C言語で配列の各要素をループで処理するように、Pandasではデータフレームの各「列」に対して同じ処理を適用します。今回は「バターワースフィルタ」という種類のフィルタを設計し、適用します。</div>
            <div id="lpf2" class="hint-content"><b>使う関数:</b> フィルタ設計には<code>scipy.signal.butter()</code>、適用には<code>scipy.signal.filtfilt()</code>を使います。</div>
            <div id="lpf3" class="hint-content"><b>実装のコツ:</b> <code>butter()</code>の<code>btype</code>引数を<code>'low'</code>に設定します。データフレームの各列に適用するには<code>df.apply(lambda col: filtfilt(b, a, col))</code>のように書くとスマートです。</div>
        </div>

        <!-- High-pass Filter -->
        <div class="hint-section">
            <h2>High-pass Filter (HPF)</h2>
            <p>信号のゆっくりとした変動（DCオフセットやドリフト）を取り除きます。</p>
            <button class="hint-button" onclick="toggleHint('hpf1')">ヒント1: 考え方</button>
            <div id="hpf1" class="hint-content"><b>考え方:</b> LPFと全く同じ手順です。フィルタの種類を指定する部分だけが変わります。</div>
            <button class="hint-button" onclick="toggleHint('hpf2')">ヒント2: LPFとの違い</button>
            <div id="hpf2" class="hint-content"><b>LPFとの違い:</b> <code>butter()</code>関数の<code>btype</code>引数を<code>'high'</code>に変えるだけで、ハイパスフィルタを設計できます。</div>
        </div>

        <!-- Notch Filter -->
        <div class="hint-section">
            <h2>Notch Filter</h2>
            <p>特定の周波数だけを狙って除去します。電源ノイズ(50Hz/60Hz)の除去によく使われます。</p>
            <button class="hint-button" onclick="toggleHint('notch1')">ヒント1: 使う関数</button>
            <button class="hint-button" onclick="toggleHint('notch2')">ヒント2: 実装</button>
            <div id="notch1" class="hint-content"><b>使う関数:</b> <code>scipy.signal.iirnotch()</code>という、まさにこの目的のための関数があります。</div>
            <div id="notch2" class="hint-content"><b>実装:</b> <code>iirnotch()</code>でフィルタ係数(b, a)を設計した後は、LPFと同じように<code>filtfilt()</code>で適用します。</div>
        </div>

        <!-- Moving Average -->
        <div class="hint-section">
            <h2>Moving Average (移動平均)</h2>
            <p>信号を滑らかにする最もシンプルな方法の一つです。</p>
            <button class="hint-button" onclick="toggleHint('ma1')">ヒント1: 考え方</button>
            <button class="hint-button" onclick="toggleHint('ma2')">ヒント2: 使う関数</button>
            <div id="ma1" class="hint-content"><b>考え方:</b> C言語ならforループで配列をずらしながら平均を計算しますが、Pandasにはもっと簡単な方法があります。</div>
            <div id="ma2" class="hint-content"><b>使う関数:</b> データフレームの<code>.rolling(window=...).mean()</code>メソッドを使います。<code>window</code>に窓のサイズを指定するだけです。</div>
        </div>

        <!-- Rectification -->
        <div class="hint-section">
            <h2>Rectification (整流)</h2>
            <p>信号のマイナス成分をプラスに折り返す（全波）か、0にする（半波）処理です。</p>
            <button class="hint-button" onclick="toggleHint('rect1')">ヒント1: 全波整流</button>
            <button class="hint-button" onclick="toggleHint('rect2')">ヒント2: 半波整流</button>
            <div id="rect1" class="hint-content"><b>全波整流:</b> 数値の絶対値を取るだけです。データフレームの<code>.abs()</code>メソッドが使えます。</div>
            <div id="rect2" class="hint-content"><b>半波整流:</b> 0より小さい値を0にクリップします。データフレームの<code>.clip(lower=0)</code>メソッドが便利です。</div>
        </div>

        <!-- RMS Envelope -->
        <div class="hint-section">
            <h2>RMS Envelope</h2>
            <p>信号の活動強度（パワー）の変動を見やすくするための処理です。</p>
            <button class="hint-button" onclick="toggleHint('rms1')">ヒント1: 手順</button>
            <div id="rms1" class="hint-content"><b>手順:</b> 以下の3ステップです。<br>1. 信号の各値を2乗する (<code>df ** 2</code>)<br>2. 2乗した信号に移動平均をかける (<code>.rolling().mean()</code>)<br>3. 全体の平方根を取る (<code>np.sqrt(...)</code> or <code>...**0.5</code>)</div>
        </div>

    </div>

    <script>
        function toggleHint(id) {
            const element = document.getElementById(id);
            if (element.style.display === "none" || element.style.display === "") {
                element.style.display = "block";
            } else {
                element.style.display = "none";
            }
        }
    </script>

</body>
</html>
